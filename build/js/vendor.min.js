"use strict";var BootstrapForm=function(e,t){this.options=t||{},this.body="";try{if("string"!=typeof e||0==e.length)throw new Error("Invalid Argument: id must a non-empty string");this.id=e}catch(i){console.log("Error: "+i.message)}};BootstrapForm.prototype.form=function(){return'<form id="'+this.id+'"name="'+this.id+'"class="'+(this.options.classes||"")+'">'+this.body+'<button type="submit" class="btn btn-success">'+(this.options.submitText||"Submit")+"</button></form>"},BootstrapForm.prototype.addInput=function(e,t,i){var a=i||{};this.body+='<div class="form-group">',this.body+='<label for="'+e+'">'+(a.label||""),a.info&&(this.body+=' <a href="#" data-toggle="tooltip" data-placement="right" title="'+a.info+'"><i class="fa fa-info-circle"></i></a>'),a.helpLink&&a.helpLink.url&&(this.body+=' <a href="'+a.helpLink.url+'" target="_blank" data-toggle="tooltip" data-placement="right" title="'+(a.helpLink.title||"")+'"><i class="fa fa-question-circle"></i></a>'),this.body+="</label>",this.body+='<input id="'+e+'" name="'+e+'" type="'+t+'"',this.body+=' class="form-control '+(a.classes||"")+'"',a.placeholder&&(this.body+=' placeholder="'+a.placeholder+'"'),this.body+=">",a.help&&(this.body+='<p class="help-block">'+a.help+"</p>"),this.body+="</div>"},$(function(){function e(e){$(e).webuiPopover($.extend({title:"Edit Cell",content:function(){var e=$(this).parent().data("row")+"-"+$(this).parent().data("col"),t=new BootstrapForm(r+"Cell-"+e,{submitText:"Save"});return t.addInput(a+"name","text",{label:"Name",info:"Valid value: <custom-ident> as defined by the W3 CSS Grid Specification.",helpLink:{url:"http://www.w3.org/TR/css-grid-1/#track-sizing",title:"Open W3 Specification"}}),t.form()+'<button id="deleteCell-'+e+'" class="btn btn-danger">Delete</button>'}},i)),$(e).off("click").on("click",function(){var e=$(this);e.webuiPopover("show");var t=$(this).parent().data("row")+"-"+$(this).parent().data("col");$('[data-toggle="tooltip"]').tooltip(),CSSGRIDGENERATOR.grid.updateDimensions(),$("#"+r+"Cell-"+t+" input").val(e.parent().data("name"));var i={rules:{},submitHandler:function(t,i){for(var r=$(t).serializeArray(),o=0;o<r.length;o++){var s=r[o].name.replace(a,"");e.parent().data(s,r[o].value.trim())}e.parent().children(".name").html(e.parent().data("name")),$("#alerts").html('<div class="alert alert-success alert-dismissible fade in" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>Success!</strong> The grid has been updated successfully.</div>'),e.webuiPopover("hide")}},o=/^\s*[0-9a-zA-Z-_]+\s*$/;i.rules[a+"name"]={pattern:o},$(".webui-popover-backdrop").off("click").on("click",function(){e.webuiPopover("hide")}),$("#deleteCell-"+t).click(function(){e.webuiPopover("destroy"),CSSGRIDGENERATOR.grid.grid.remove_widget(e.parent(),function(){})}),$("#"+r+"Cell-"+t).submit(function(e){e.preventDefault()}).validate(i)})}function t(){var e=/^\s*(auto|0)$|^[+-]?[0-9]+.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)$\s*/,t=/^\s*((auto|0)|[+-]?[0-9]+.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)|max-content|min-content|[0-9]+fr|minmax\(\s*((auto|0)|[+-]?[0-9]+.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)|max-content|min-content|[0-9]+fr)\s*,\s*((auto|0)|[+-]?[0-9]+.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)|max-content|min-content|[0-9]+fr)\s*\))\s*$/,o=[{machine:"col",human:"Column"},{machine:"row",human:"Row"}];o.forEach(function(o){$('[data-toggle="popover"].edit.edit-'+o.machine).webuiPopover($.extend({title:"Edit "+o.human,content:function(){var e=$(this).parent().data(o.machine),t=new BootstrapForm(r+o.human+"-"+e,{submitText:"Save"});return t.addInput(a+"gridTemplate"+o.human+"-"+e,"text",{label:"Width",info:"Valid values: <length>, <percentage>, <flex>, max-content, min-content, minmax(min, max), and auto as defined by the W3 CSS Grid Specification.",helpLink:{url:"http://www.w3.org/TR/css-grid-1/#track-sizing",title:"Open W3 Specification"}}),t.addInput(a+"grid"+o.human+"Gap","text",{label:"Gap",help:"The horizontal space between columns. This is the same for all columns.",info:"Valid value: <length> as defined by the W3 CSS Grid Specification.",helpLink:{url:"http://www.w3.org/TR/css-grid-1/#gutters",title:"Open W3 Specification"}}),t.form()}},i)),$('[data-toggle="popover"].edit.edit-'+o.machine).off("click").on("click",function(){var i=$(this);i.webuiPopover("show");var s=$(this).parent().data(o.machine);$('[data-toggle="tooltip"]').tooltip(),CSSGRIDGENERATOR.grid.updateDimensions(),$("#"+r+o.human+"-"+s+" input").each(function(){var e=$(this)[0].id.replace(a,"");if(e.match(/Template/)){var t=e.match(/[0-9]+/);e=e.replace(/-[0-9]+/,"")+"s",$(this).val(CSSGRIDGENERATOR.grid[e][t.pop()])}else e.match(/Gap/)&&$(this).val(CSSGRIDGENERATOR.grid[e])});var n={rules:{},submitHandler:function(e,t){for(var r=$(e).serializeArray(),o=0;o<r.length;o++){var s=r[o].name.replace(a,"");if(s.match(/Gap/))CSSGRIDGENERATOR.grid[s]=r[o].value;else if(s.match(/Template/)){var n=s.match(/[0-9]+/);s=s.replace(/-[0-9]+/,""),s=s.replace(/-[0-9]+/,"")+"s",CSSGRIDGENERATOR.grid[s][n.pop()]=r[o].value}}$("#alerts").html('<div class="alert alert-success alert-dismissible fade in" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>Success!</strong> The grid has been updated successfully.</div>'),i.webuiPopover("hide")}};n.rules[a+"gridTemplate"+o.human+"-"+s]={pattern:t},n.rules[a+"grid"+o.human+"Gap"]={pattern:e},$(".webui-popover-backdrop").off("click").on("click",function(){i.webuiPopover("hide")}),$("#"+r+o.human+"-"+s).submit(function(e){e.preventDefault()}).validate(n)})})}var i={animation:"fade",closeable:!0,cache:"false",trigger:"manual",backdrop:!0},a="editCol-",r="editForm-";t(),e('[data-toggle="popover"].edit.edit-cell');var o=17,s=10,n=$("body").innerWidth()-o-s,l=15,d=12;n-=24*l;var p=Math.floor(n/d),c='<style type="text/css">.index.index-col li {width: '+p+"px;margin-left: "+l+"px;margin-right: "+l+"px;}.index.index-row li {height: "+(p+2*l)+"px;line-height: "+p+"px;padding-top: "+l+"px;padding-left: "+s+"px;padding-bottom: "+l+"px;}</style>";$("head").append(c),$("#grid").gridster({widget_margins:[l,l],widget_base_dimensions:[p,p],serialize_params:function(e,t){var i={col:t.col,row:t.row,extra_cols:0,size_x:t.size_x,size_y:t.size_y,name:t.el.data("name")};return i},resize:{enabled:!0}}),CSSGRIDGENERATOR.grid.grid=$("#grid").gridster().data("gridster"),CSSGRIDGENERATOR.grid.grid.set_dom_grid_width=function(e){Gridster.prototype.set_dom_grid_width.call(this,e),"undefined"==typeof e&&(e=this.get_highest_occupied_cell().col);var t=this.options.autogrow_cols?this.options.max_cols:this.cols;return e=Math.min(t,Math.max(e,this.options.min_cols)),$("#index-col li").each(function(t){$(this).css("display",e>t?"block":"none")}),this},CSSGRIDGENERATOR.grid.grid.set_dom_grid_height=function(e){if(Gridster.prototype.set_dom_grid_height.call(this,e),"undefined"==typeof e){var t=this.get_highest_occupied_cell().row;e=t*this.min_widget_height}var i=p+2*l,a=e/i;return $("#index-row li").each(function(e){$(this).css("display",a>e?"block":"none")}),this},$("#export").click(function(){CSSGRIDGENERATOR.grid.exportCSS()}),$("#addCell").click(function(){var t=CSSGRIDGENERATOR.grid.addElement(),i='li[data-row="'+$(t).data("row")+'"][data-col="'+$(t).data("col")+'"] .edit.edit-cell[data-toggle="popover"]';console.log(i),console.log($(i)),e(i)}),$("#editGrid").click(function(){CSSGRIDGENERATOR.grid.edit()})}),String.prototype.toProperCase=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})};var CSSGRIDGENERATOR=CSSGRIDGENERATOR||{};CSSGRIDGENERATOR.grid={grid:{},gridTemplateRows:["auto"],gridTemplateColumns:["auto"],gridColumnGap:"0",gridRowGap:"0",cols:1,rows:1,updateDimensions:function(){var e=this;this.cols=0,this.rows=0,this.grid.serialize().forEach(function(t,i){e.cols=Math.max(t.col+t.size_x-1,e.cols),e.rows=Math.max(t.row+t.size_y-1,e.rows)});for(var t=0;t<this.cols;t++)"undefined"==typeof this.gridTemplateColumns[t]&&(this.gridTemplateColumns[t]="auto");for(var i=0;i<this.rows;i++)"undefined"==typeof this.gridTemplateRows[i]&&(this.gridTemplateRows[i]="auto");this.gridTemplateColumns=this.gridTemplateColumns.slice(0,this.cols),this.gridTemplateRows=this.gridTemplateRows.slice(0,this.rows)},edit:function(){var e="editGrid-",t="editGridForm",a=this,r=new BootstrapForm(t);r.addInput(e+"gridColumnGap","text",{label:"Column Gap"}),r.addInput(e+"gridRowGap","text",{label:"Row Gap"}),this.updateDimensions();for(var o=0;o<this.cols;o++)r.addInput(e+"gridTemplateColumns-"+o,"text",{label:"Column: "+(o+1)});for(var s=0;s<this.rows;s++)r.addInput(e+"gridTemplateRows-"+s,"text",{label:"Row: "+(s+1)});var n="<h2>Edit Grid</h2>"+r.form();$("#sidebar").html(n),$("#"+t+" input").each(function(){var t=$(this)[0].id.replace(e,"");if(t.match(/Template/)){var i=t.match(/[0-9]+/);t=t.replace(/-[0-9]+/,""),$(this).val(a[t][i.pop()])}else $(this).val(a[t])});var l=/^\s*(auto|0)$|^[+-]?[0-9]+.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)$\s*/,d=/^\s*((auto|0)|[+-]?[0-9]+.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)|max-content|min-content|[0-9]+fr|minmax\(\s*((auto|0)|[+-]?[0-9]+.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)|max-content|min-content|[0-9]+fr)\s*,\s*((auto|0)|[+-]?[0-9]+.?([0-9]+)?(px|em|ex|%|in|cm|mm|pt|pc)|max-content|min-content|[0-9]+fr)\s*\))\s*$/,p={rules:{},submitHandler:function(t,r){var o=$(t).serializeArray();for(i=0;i<o.length;i++){var s=o[i].name.replace(e,"");if(s.match(/Gap/))a[s]=o[i].value;else if(s.match(/Template/)){var n=s.match(/[0-9]+/);s=s.replace(/-[0-9]+/,""),a[s][n.pop()]=o[i].value}}$("#st-container").removeClass("st-menu-open"),$("#alerts").html('<div class="alert alert-success alert-dismissible fade in" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>Success!</strong> The grid has been updated successfully.</div>'),$("#sidebar").delay(500).queue(function(){$(this).html(""),$(this).dequeue()}).delay(500).queue(function(){})}};p.rules[e+"gridColumnGap"]={pattern:l},p.rules[e+"gridRowGap"]={pattern:l};for(var o=0;o<this.cols;o++)p.rules[e+"gridTemplateColumns-"+o]={pattern:d};for(var s=0;s<this.rows;s++)p.rules[e+"gridTemplateRows-"+s]={pattern:d};$("#"+t).off("submit").on("submit",function(e){e.preventDefault()}).validate(p)},addElement:function(){var e={html:'<li data-name=\'\'><button type="button" data-toggle="popover" class="btn btn-default edit edit-cell"><span class="fa fa-lg fa-pencil"></span> <span class="sr-only">Edit</span></button><span class=\'name\'></span></li>',sizex:1,sizey:1};return this.grid.add_widget(e.html,e.sizex,e.sizey)},exportCSS:function(){function e(e,t,i){t="undefined"!=typeof t?t:"  ",i="undefined"!=typeof i?i:"<br>";var a="";if(e.hasOwnProperty("selector")&&e.hasOwnProperty("properties")){a=e.selector+" {"+i;for(var r in e.properties)a+=t+r+": "+e.properties[r]+";"+i;a+="}"+i}else a=void 0;return a}function t(e){var t=!0;return e.serialize().forEach(function(e,i){e.hasOwnProperty("name")&&"string"==typeof e.name&&e.name&&0!==e.name.length||(t=!1)}),t?"areas":"coords"}var i="";switch(this.updateDimensions(),t(this.grid)){case"areas":var a=[];this.grid.serialize().forEach(function(t,r){var o=t.name.match(/^[0-9]/),s=o?"\\3"+o.pop()+" "+t.name.substr(1):t.name;i+=e({selector:"#"+s,properties:{"grid-area":s}});for(var n=t.col,l=t.col+t.size_x,d=t.row,p=t.row+t.size_y,c=d-1;p-1>c;c++)for(var m=n-1;l-1>m;m++)"undefined"==typeof a[c]&&(a[c]=[]),a[c][m]=t.name});var r=this.gridTemplateColumns.join(" "),o=this.gridTemplateRows.join(" "),s="";for(var n in a)s+='"'+a[n].join(" ")+'" ';for(var s="",l=0;l<this.rows;l++){s+=l>0?' "':'"';for(var d=0;d<this.cols;d++)s+=d>0?" ":"",s+="undefined"!=typeof a[l][d]?a[l][d]:".";s+='"'}i=e({selector:"#grid",properties:{display:"grid","grid-template-areas":s,"grid-template-columns":r,"grid-template-rows":o,"grid-gap":this.gridColumnGap+" "+this.gridRowGap}})+i;break;case"coords":this.grid.serialize().forEach(function(t,a){i+=e({selector:"#area-"+(a+1),properties:{"grid-column-start":t.col,"grid-column-end":t.col+t.size_x,"grid-row-start":t.row,"grid-row-end":t.row+t.size_y}})});var r=this.gridTemplateColumns.join(" ");o=this.gridTemplateRows.join(" "),i=e({selector:"#grid",properties:{display:"grid","grid-template-columns":r,"grid-template-rows":o,"grid-gap":this.gridColumnGap+" "+this.gridRowGap}})+i}$("#exportResult").html(i)}};